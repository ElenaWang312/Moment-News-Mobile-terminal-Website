"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var _createClass=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),_get=function(e,t,a){for(var n=!0;n;){var s=e,i=t,r=a;n=!1,null===s&&(s=Function.prototype);var c=Object.getOwnPropertyDescriptor(s,i);if(void 0!==c){if("value"in c)return c.value;var l=c.get;return void 0===l?void 0:l.call(r)}var o=Object.getPrototypeOf(s);if(null===o)return void 0;e=o,t=i,a=r,n=!0,c=o=void 0}},_React=React,Component=_React.Component,_ReactDOM=ReactDOM,render=_ReactDOM.render,Util=function(e){function t(){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return _inherits(t,e),_createClass(t,[{key:"ajax",value:function(e,t){var a=new XMLHttpRequest;a.onreadystatechange=function(){4===a.readyState&&200===a.status&&t(JSON.parse(a.responseText))},a.open("GET",e,!0),a.send(null)}}]),t}(Component),List=function(e){function t(){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return _inherits(t,e),_createClass(t,[{key:"getimage",value:function(){return this.props.img.map(function(e,t){return React.createElement("li",{key:t},React.createElement("img",{src:e.img,alt:""}),React.createElement("p",null,e.news))})}},{key:"getcircle",value:function(){return this.props.img.map(function(e,t){return React.createElement("span",{key:t,style:{right:12*t+10+"px"},className:"moren"})})}},{key:"carrousel",value:function(){return React.createElement("ul",{className:"carrou",ref:"carcontainer"},this.getimage())}},{key:"creatList",value:function(){var e=this;return this.props.data.map(function(t,a){return React.createElement("li",{"data-id":t.id,onClick:e.goDetail.bind(e,t.id),key:a,className:"newsli"},React.createElement("img",{src:t.img}),React.createElement("h3",null,t.title),React.createElement("p",null,t.content),React.createElement("span",null,"评论:"+t.comment))})}},{key:"goDetail",value:function(e){this.props.showDetail(e)}},{key:"render",value:function(){return React.createElement("div",{className:"list"},React.createElement("div",{className:"carrousel"},this.carrousel()),React.createElement("div",{className:"clear"}),React.createElement("ul",null,this.creatList()))}},{key:"componentDidMount",value:function(){var e=this.refs.carcontainer,t=3,a=this.props.dis;new Carrousel(e,t,a)}}]),t}(Util),Detail=function(e){function t(){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return _inherits(t,e),_createClass(t,[{key:"goComment",value:function(e){this.props.showComment(e)}},{key:"render",value:function(){var e={__html:this.props.data.content};return React.createElement("div",{className:"detail"},React.createElement("h1",null,this.props.data.title),React.createElement("p",{className:"detail-comment"},React.createElement("span",null,"评论数："+this.props.data.comment)),React.createElement("img",{src:this.props.data.img}),React.createElement("p",{className:"detail-content",dangerouslySetInnerHTML:e}),React.createElement("div",{className:"btn",onClick:this.goComment.bind(this,this.props.data.id)},"查看更多评论"))}}]),t}(Component),Comment=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.state={list:this.props.data.list||[],id:this.props.data.id||""}}return _inherits(t,e),_createClass(t,[{key:"componentWillReceiveProps",value:function(e){this.state={list:e.data.list||[],id:e.data.id||""}}},{key:"createCommentList",value:function(){return this.state.list.map(function(e,t){return React.createElement("li",{key:t},React.createElement("h3",null,e.user),React.createElement("p",null,e.content),React.createElement("span",null,e.time))})}},{key:"submitData",value:function(){var e=this,t=this.refs.inputmsg,a=t.value,n=new Date,s={id:this.state.id,user:"Elena",time:"刚刚  "+n.getHours()+":"+n.getMinutes()+":"+n.getSeconds(),content:a};this.ajax("data/addComment.json?date="+n,function(a){if(a&&0===a.errno){var n=e.state.list;n.unshift(s),e.setState({list:n}),t.value="",alert("评论提交成功")}})}},{key:"render",value:function(){return React.createElement("div",{className:"comment"},React.createElement("div",{className:"container"},React.createElement("div",{className:"message"},React.createElement("textarea",{ref:"inputmsg",placeholder:"文明上网，理性发言！"})),React.createElement("div",{className:"btn clearfix"},React.createElement("span",{onClick:this.submitData.bind(this)},"提交"))),React.createElement("ul",null,this.createCommentList()))}}]),t}(Util),Header=function(e){function t(){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return _inherits(t,e),_createClass(t,[{key:"render",value:function(){return React.createElement("header",{className:"header"},React.createElement("div",{className:"login"}),React.createElement("div",{className:"go-back",onClick:this.props.goback},React.createElement("span",{className:"arrow"},React.createElement("span",{className:"arrow"}))),React.createElement("h1",null,"一刻新闻"))}}]),t}(Component),App=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.state={page:this.props.page,list:[],detail:{},comment:{},img:[]}}return _inherits(t,e),_createClass(t,[{key:"goDetail",value:function(e){var t=this;this.ajax("data/detail.json?id="+e,function(e){e&&0===e.errno&&t.setState({detail:e.data,page:"detail"})})}},{key:"goComment",value:function(e){var t=this;this.ajax("data/comment.json?id="+e,function(e){e&&0===e.errno&&t.setState({comment:e.data,page:"comment"})})}},{key:"goBack",value:function(){switch(this.state.page){case"comment":this.setState({page:"detail"});break;case"detail":this.setState({page:"list"});break;case"list":return}}},{key:"render",value:function(){return React.createElement("div",{className:"main"},React.createElement(Header,{goback:this.goBack.bind(this)}),React.createElement("div",{style:{display:"list"===this.state.page?"block":"none"}},React.createElement(List,{data:this.state.list,showDetail:this.goDetail.bind(this),img:this.state.img,dis:"list"===this.state.page?!0:!1})),React.createElement("div",{style:{display:"detail"===this.state.page?"block":"none"}},React.createElement(Detail,{data:this.state.detail,showComment:this.goComment.bind(this)})),React.createElement("div",{style:{display:"comment"===this.state.page?"block":"none"}},React.createElement(Comment,{data:this.state.comment})))}},{key:"componentDidMount",value:function(){var e=this;this.ajax("data/list.json",function(t){t&&0===t.errno&&e.setState({list:t.data})}),this.ajax("data/img.json",function(t){t&&0===t.errno&&e.setState({img:t.data})})}}]),t}(Util);render(React.createElement(App,{page:"list"}),document.getElementById("app"));